OAuth
===

+ redirect_uri がフラグメント (#なんちゃら) を含んでいたらエラー。


OpenID Connect
===

+ ID トークンが iss クレームとして IdP の ID を含む。
+ ID トークンが sub クレームとしてアカウント ID を含む。
+ ID トークンが aud クレームとして要求元 TA の ID を含む。
+ ID トークンが exp クレームとして有効期限を含む。
+ ID トークンが iat クレームとして発行日時を含む。
+ リクエストに max_age が含まれる場合、ID トークンが auth_time クレームとしてアカウント認証日時を含む。
+ リクエストに nonce が含まれる場合、ID トークンが nonce クレームとしてその値を含む。
+ ID トークンは JWS と JWE で署名・暗号化れる。


+ 認可エンドポイントは GET と POST に対応する。
+ リクエストに scope パラメータが無ければエラー。
+ リクエストに response_type パラメータが無ければエラー。
+ リクエストに client_id パラメータが無ければエラー。
+ リクエストに redirect_uri パラメータが無ければエラー。
+ redirect_uri パラメータの値が事前登録されたもののいずれかと一致しなければエラー。
+ リクエストに prompt パラメータがあれば、UI を表示しない。
+ promp パラメータの値が none を含み、UI を表示させなければ処理が続かない場合はエラー。
+ promp パラメータの値が login であり、アカウントを認証できない場合はエラー。
+ promp パラメータの値が consent であり、同意を得られない場合はエラー。
+ promp パラメータの値が select_account であり、アカウントを選択できない場合はエラー。
+ リクエストに max_age が含まれ、アカウントが明示的に認証されてからの経過時間がその値より大きければ、アカウントを明示的に認証する。


+ トークンリクエストに grant_type パラメータが無ければエラー。
+ grant_type パラメータの値が authorization_code でなければエラー。
